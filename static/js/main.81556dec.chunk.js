(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,n){e.exports=n(84)},43:function(e,t,n){},57:function(e,t,n){},59:function(e,t,n){},61:function(e,t,n){},63:function(e,t,n){},74:function(e,t,n){},78:function(e,t,n){},80:function(e,t,n){},82:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),s=n(11),r=n.n(s),c=n(10),l=n(3),i=n(4),u=n(6),h=n(5),m=n(7),f=(n(43),n(15)),d=n.n(f),k=(n(57),n(17)),p="https://reactnd-books-api.udacity.com",b=localStorage.token;b||(b=localStorage.token=Math.random().toString(36).substr(-8));var v={Accept:"application/json",Authorization:b},g=function(){return fetch("".concat(p,"/books"),{headers:v}).then(function(e){return e.json()}).then(function(e){return e.books})},S=function(e,t){return fetch("".concat(p,"/books/").concat(e.id),{method:"PUT",headers:Object(k.a)({},v,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},y=function(e,t){return fetch("".concat(p,"/books/").concat(e),{method:"PUT",headers:Object(k.a)({},v,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},E=function(e){return fetch("".concat(p,"/search"),{method:"POST",headers:Object(k.a)({},v,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})},N=n(34),O=n(8);n(59);var B=function(e){var t=e.rate,n=o.a.useState(t),a=Object(O.a)(n,2),s=a[0],r=a[1];return o.a.createElement("div",{className:"star-rating"},Object(N.a)(Array(5)).map(function(t,n){return n+=1,o.a.createElement("button",{type:"button",key:n,className:n<=s?"on":"off",onClick:function(){r(n);var t={id:e.bookId,rate:n};if(localStorage.getItem("rating")){var a=JSON.parse(localStorage.getItem("rating")),o=a.find(function(t){return t.id===e.bookId});if(o)if(o.rate!==t.rate)o.rate=t.rate,localStorage.setItem("rating",JSON.stringify(a));else{var s=a.indexOf(o);a.splice(s,1),a.length>0?localStorage.setItem("rating",JSON.stringify(a)):localStorage.removeItem("rating"),r(0)}else a.push(t),localStorage.setItem("rating",JSON.stringify(a))}else{var c=[];c.push(t),localStorage.setItem("rating",JSON.stringify(c))}}},o.a.createElement("span",{className:"star"},"\u2605"))}))},j=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={showMenu:!1,selected:n.props.book.shelf,name:n.props.book.id,showCheckBox:!1,bookSelected:!1},n.toggleShowMenu=function(){n.setState(function(e){return{showMenu:!e.showMenu}})},n.selectShelf=function(e,t){S(t,e).then(function(t){n.setState({selected:e}),n.props.shelf()})},n.onBookHover=function(){n.setState({showCheckBox:!0})},n.onBookHoverLeave=function(){n.setState({showCheckBox:!1})},n.ref=o.a.createRef(),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"onClickOutside",value:function(){this.setState({showMenu:!1})}},{key:"handleClickOutside",value:function(e){this.ref.current&&!this.ref.current.contains(e.target)&&this.onClickOutside()}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleClickOutside.bind(this),!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClickOutside.bind(this),!0)}},{key:"selectBook",value:function(e){this.setState({bookSelected:e.target.checked}),this.props.selectBook(e.target.checked);var t=JSON.parse(localStorage.getItem("selectedBooks"));if(e.target.checked&&!t){var n=[this.props.book.id];localStorage.setItem("selectedBooks",JSON.stringify(n))}else if(e.target.checked&&t)t.push(this.props.book.id),localStorage.setItem("selectedBooks",JSON.stringify(t));else if(t){var a=t.indexOf(this.props.book.id);t.splice(a,1),t.length>0?localStorage.setItem("selectedBooks",JSON.stringify(t)):localStorage.removeItem("selectedBooks")}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{onMouseEnter:this.onBookHover,onMouseLeave:this.onBookHoverLeave,className:"book ".concat(this.state.bookSelected?"selected-book":"")},o.a.createElement("div",{className:"book-right"},o.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url(".concat(this.props.book.imageLinks?this.props.book.imageLinks.thumbnail:""," )")}})),o.a.createElement("div",{className:"book-left"},o.a.createElement("div",{className:"book-title"},this.props.book.title," "),o.a.createElement("div",{className:"book-authors"},"By: ",this.props.book.authors?this.props.book.authors.map(function(e){return o.a.createElement("span",{key:e},e+", ")}):""),o.a.createElement("div",{ref:this.ref,className:"book-shelf-changer",onClick:this.toggleShowMenu},this.state.showMenu?o.a.createElement("div",{className:"book-menu"},o.a.createElement("p",{className:"move-to-text"},"Move to..."),o.a.createElement("div",{className:"book-menu-item ".concat("currentlyReading"===this.state.selected?"selected":""),onClick:function(t,n){return e.selectShelf("currentlyReading",e.props.book)}},"Currently Reading"),o.a.createElement("div",{className:"book-menu-item ".concat("wantToRead"===this.state.selected?"selected":""),onClick:function(t,n){return e.selectShelf("wantToRead",e.props.book)}},"Want to Read"),o.a.createElement("div",{className:"book-menu-item ".concat("read"===this.state.selected?"selected":""),onClick:function(t,n){return e.selectShelf("read",e.props.book)}},"Read"),o.a.createElement("div",{className:"book-menu-item ".concat("None"===this.state.selected||void 0===this.state.selected?"selected":""),onClick:function(t,n){return e.selectShelf("None",e.props.book)}},"None")):""),o.a.createElement(B,{bookId:this.props.book.id,rate:localStorage.getItem("rating")&&JSON.parse(localStorage.getItem("rating")).find(function(t){return t.id===e.props.book.id})?JSON.parse(localStorage.getItem("rating")).find(function(t){return t.id===e.props.book.id}).rate:0}),o.a.createElement("label",{style:{display:this.state.showCheckBox||this.state.bookSelected?"inline-block":"none"},className:"pure-material-checkbox"},o.a.createElement("input",{onChange:function(t){e.selectBook(t)},type:"checkbox",defaultChecked:!(!localStorage.getItem("selectedBooks")||!JSON.parse(localStorage.getItem("selectedBooks")).find(function(t){return t===e.props.book.id}))}),o.a.createElement("span",null)))))}}]),t}(a.Component),C=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={books:[],query:"",spinner:!1},n.timeout=null,n.handleShelfChange=function(){E(n.state.query).then(function(e){n.setState({books:e})})},n.handleSelectBook=function(e){n.props.selectBook(e)},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"onSearch",value:function(e){var t=this,n=JSON.parse(localStorage.getItem("books")),a=e.target.value.trim();clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.setState({spinner:!0}),""!==e.target.value.trim()?E(a).then(function(e){var o=Array.isArray(e)&&e.filter(function(e){return e.imageLinks&&void 0!==e.imageLinks.thumbnail?e:""});o&&o.map(function(e){var t=n.find(function(t){return t.id===e.id});return t?e.shelf=t.shelf:e}),t.setState({books:o,query:a}),t.setState({spinner:!1})}):(t.setState({books:[],query:""}),t.setState({spinner:!1}))},1e3)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"search-books"},o.a.createElement("div",{className:"search-books-bar"},o.a.createElement(c.b,{to:"/"},o.a.createElement("button",{className:"close-search"},"Close")),o.a.createElement("div",{className:"search-books-input-wrapper"},o.a.createElement("input",{type:"text",placeholder:"Search by title or author",onChange:function(t){e.onSearch(t)}}))),o.a.createElement(d.a,{active:this.state.spinner,spinner:!0,text:"Loading your content..."},o.a.createElement("div",{className:"search-books-results"},o.a.createElement("ol",{className:"books-grid ".concat(""===this.state.query?"display-none":"")},this.state.books&&this.state.books.length>0?this.state.books.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(j,{book:t,shelf:e.handleShelfChange,selectBook:function(t){return e.handleSelectBook(t)}}))}):o.a.createElement("p",null,"No results found. Please refine your search")))))}}]),t}(a.Component),w=(n(61),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).handleShelfChange=function(){n.props.refresh()},n.handleSelectBook=function(e){n.props.selectBook(e)},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"bookshelf",id:this.props.title.replace(/\s+/g,"")},o.a.createElement("h2",{className:"bookshelf-title"},this.props.title),o.a.createElement("div",{className:"bookshelf-books"},o.a.createElement("ol",{className:"books-grid"},this.props.books.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(j,{book:t,shelf:e.handleShelfChange,selectBook:function(t){return e.handleSelectBook(t)}}))}))))}}]),t}(a.Component)),R=(n(63),n(16));var I=function(){return o.a.createElement("div",{className:"list-books-title"},o.a.createElement("div",{className:"left-side"},o.a.createElement("h1",null,"MyReads")),o.a.createElement("div",{className:"right-side"},o.a.createElement(R.Link,{activeClass:"active",to:"CurrentlyReading",spy:!0,smooth:!0,offset:-70,duration:500,className:"smooth-link"},"Currently Reading"),o.a.createElement(R.Link,{activeClass:"active",to:"WanttoRead",spy:!0,smooth:!0,offset:-70,duration:500,className:"smooth-link"},"Want to Read"),o.a.createElement(R.Link,{activeClass:"active",to:"Read",spy:!0,smooth:!0,offset:-70,duration:500,className:"smooth-link"},"Read")))},J=(n(74),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).bookShelves=[{id:"currentlyReading",title:"Currently Reading"},{id:"wantToRead",title:"Want to Read"},{id:"read",title:"Read"}],n.state={books:[]},n.getAllBooks=function(){g().then(function(e){n.setState(function(t){if(JSON.stringify(t.books)===JSON.stringify(e))return{books:[]}}),setTimeout(function(){n.setState(function(){return{books:e}}),localStorage.setItem("books",JSON.stringify(e))},0)})},n.componentDidMount=function(){n.getAllBooks()},n.handleRefresh=function(){n.getAllBooks()},n.handleSelectBook=function(e){n.props.selectBookEvent(e)},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(d.a,{active:0===this.state.books.length,spinner:!0,text:"Loading your content..."},o.a.createElement("div",{className:"list-books"},o.a.createElement(I,null),o.a.createElement("div",{className:"list-books-content"},o.a.createElement("div",null,this.bookShelves.map(function(t){return e.state.books.length>0?o.a.createElement(w,{key:t.id,title:t.title,books:e.state.books.filter(function(e){return e.shelf===t.id}),refresh:e.handleRefresh,selectBook:e.handleSelectBook}):""}))),o.a.createElement("div",{className:"open-search",title:"koko"},o.a.createElement(c.b,{to:"/search"},o.a.createElement("button",null,"Search a book")))))}}]),t}(a.Component)),M=n(0),A=n(24),x=n.n(A),L=n(33),T=(n(78),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).moveAll=function(){var e=Object(L.a)(x.a.mark(function e(t){var a,o;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=JSON.parse(localStorage.getItem("selectedBooks")),o=a.map(function(e){return new Promise(function(n,a){y(e,t).then(function(e){return n(e)})})}),Promise.all(o).finally(function(){localStorage.removeItem("selectedBooks"),n.props.afterMove()});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.unselectAll=function(){localStorage.removeItem("selectedBooks"),n.props.afterMove()},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{display:this.props.select||localStorage.getItem("selectedBooks")&&JSON.parse(localStorage.getItem("selectedBooks")).length>0?"block":"none"},className:"bucket-container"},o.a.createElement("p",{className:"move-all"},"Move all to:"),o.a.createElement("div",{className:"btns-container"},o.a.createElement("span",{className:"cat-name-button",onClick:function(){return e.moveAll("currentlyReading")}},"Currently Reading"),o.a.createElement("span",{className:"cat-name-button",onClick:function(){return e.moveAll("wantToRead")}},"Want To Read"),o.a.createElement("span",{className:"cat-name-button",onClick:function(){return e.moveAll("read")}},"Read")),o.a.createElement("span",{className:"remove-all",title:"Unselect All",onClick:this.unselectAll}))}}]),t}(a.Component)),q=(n(80),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={selectBook:!1},n.selectBookEvent=function(e,t){n.setState({selectBook:e});var a=window.location;"afterMove"===t&&"/search"!==a.pathname&&n.myRef.current.getAllBooks(),"afterMove"===t&&"/search"===a.pathname&&(window.location.pathname="/")},n.myRef=o.a.createRef(),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"app"},o.a.createElement("span",{className:"test"}),o.a.createElement(M.c,null,o.a.createElement(M.a,{path:"/",element:o.a.createElement(J,{selectBookEvent:function(t){return e.selectBookEvent(t)},ref:this.myRef})}),o.a.createElement(M.a,{path:"/search",element:o.a.createElement(C,{selectBook:function(t){return e.selectBookEvent(t)}})})),o.a.createElement(T,{select:this.state.selectBook,afterMove:function(t){return e.selectBookEvent(!1,"afterMove")}}))}}]),t}(o.a.Component));n(82);r.a.createRoot(document.getElementById("root")).render(o.a.createElement(c.a,null,o.a.createElement(q,null)))}},[[35,2,1]]]);
//# sourceMappingURL=main.81556dec.chunk.js.map