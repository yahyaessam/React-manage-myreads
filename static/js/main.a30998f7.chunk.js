(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,a){e.exports=a(84)},43:function(e,t,a){},57:function(e,t,a){},59:function(e,t,a){},61:function(e,t,a){},63:function(e,t,a){},74:function(e,t,a){},78:function(e,t,a){},80:function(e,t,a){},82:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),s=a(11),r=a.n(s),c=a(10),l=a(3),i=a(4),u=a(6),m=a(5),h=a(7),f=(a(43),a(15)),d=a.n(f),k=(a(57),a(17)),p="https://reactnd-books-api.udacity.com",b=localStorage.token;b||(b=localStorage.token=Math.random().toString(36).substr(-8));var v={Accept:"application/json",Authorization:b},g=function(){return fetch("".concat(p,"/books"),{headers:v}).then(function(e){return e.json()}).then(function(e){return e.books})},S=function(e,t){return fetch("".concat(p,"/books/").concat(e.id),{method:"PUT",headers:Object(k.a)({},v,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},y=function(e,t){return fetch("".concat(p,"/books/").concat(e),{method:"PUT",headers:Object(k.a)({},v,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},E=function(e){return fetch("".concat(p,"/search"),{method:"POST",headers:Object(k.a)({},v,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})},N=a(34),O=a(8);a(59);var B=function(e){var t=e.rate,a=o.a.useState(t),n=Object(O.a)(a,2),s=n[0],r=n[1];return o.a.createElement("div",{className:"star-rating"},Object(N.a)(Array(5)).map(function(t,a){return a+=1,o.a.createElement("button",{type:"button",key:a,className:a<=s?"on":"off",onClick:function(){r(a);var t={id:e.bookId,rate:a};if(localStorage.getItem("rating")){var n=JSON.parse(localStorage.getItem("rating")),o=n.find(function(t){return t.id===e.bookId});if(o)if(o.rate!==t.rate)o.rate=t.rate,localStorage.setItem("rating",JSON.stringify(n));else{var s=n.indexOf(o);n.splice(s,1),n.length>0?localStorage.setItem("rating",JSON.stringify(n)):localStorage.removeItem("rating"),r(0)}else n.push(t),localStorage.setItem("rating",JSON.stringify(n))}else{var c=[];c.push(t),localStorage.setItem("rating",JSON.stringify(c))}}},o.a.createElement("span",{className:"star"},"\u2605"))}))},j=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showMenu:!1,selected:a.props.book.shelf,name:a.props.book.id,showCheckBox:!1,bookSelected:!1},a.toggleShowMenu=function(){a.setState(function(e){return{showMenu:!e.showMenu}})},a.selectShelf=function(e,t){S(t,e).then(function(t){a.setState({selected:e}),a.props.shelf()})},a.onBookHover=function(){a.setState({showCheckBox:!0})},a.onBookHoverLeave=function(){a.setState({showCheckBox:!1})},a.ref=o.a.createRef(),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"onClickOutside",value:function(){this.setState({showMenu:!1})}},{key:"handleClickOutside",value:function(e){this.ref.current&&!this.ref.current.contains(e.target)&&this.onClickOutside()}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleClickOutside.bind(this),!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClickOutside.bind(this),!0)}},{key:"selectBook",value:function(e){this.setState({bookSelected:e.target.checked}),this.props.selectBook(e.target.checked);var t=JSON.parse(localStorage.getItem("selectedBooks"));if(e.target.checked&&!t){var a=[this.props.book.id];localStorage.setItem("selectedBooks",JSON.stringify(a))}else if(e.target.checked&&t)t.push(this.props.book.id),localStorage.setItem("selectedBooks",JSON.stringify(t));else if(t){var n=t.indexOf(this.props.book.id);t.splice(n,1),t.length>0?localStorage.setItem("selectedBooks",JSON.stringify(t)):localStorage.removeItem("selectedBooks")}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{onMouseEnter:this.onBookHover,onMouseLeave:this.onBookHoverLeave,className:"book ".concat(this.state.bookSelected?"selected-book":"")},o.a.createElement("div",{className:"book-right"},o.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url(".concat(this.props.book.imageLinks?this.props.book.imageLinks.thumbnail:""," )")}})),o.a.createElement("div",{className:"book-left"},o.a.createElement("div",{className:"book-title"},this.props.book.title," "),o.a.createElement("div",{className:"book-authors"},"By: ",this.props.book.authors?this.props.book.authors.map(function(e){return o.a.createElement("span",{key:e},e+", ")}):""),o.a.createElement("div",{ref:this.ref,className:"book-shelf-changer",onClick:this.toggleShowMenu},this.state.showMenu?o.a.createElement("div",{className:"book-menu"},o.a.createElement("p",{className:"move-to-text"},"Move to..."),o.a.createElement("div",{className:"book-menu-item ".concat("currentlyReading"===this.state.selected?"selected":""),onClick:function(t,a){return e.selectShelf("currentlyReading",e.props.book)}},"Currently Reading"),o.a.createElement("div",{className:"book-menu-item ".concat("wantToRead"===this.state.selected?"selected":""),onClick:function(t,a){return e.selectShelf("wantToRead",e.props.book)}},"Want to Read"),o.a.createElement("div",{className:"book-menu-item ".concat("read"===this.state.selected?"selected":""),onClick:function(t,a){return e.selectShelf("read",e.props.book)}},"Read"),o.a.createElement("div",{className:"book-menu-item ".concat("None"===this.state.selected||void 0===this.state.selected?"selected":""),onClick:function(t,a){return e.selectShelf("None",e.props.book)}},"None")):""),o.a.createElement(B,{bookId:this.props.book.id,rate:localStorage.getItem("rating")&&JSON.parse(localStorage.getItem("rating")).find(function(t){return t.id===e.props.book.id})?JSON.parse(localStorage.getItem("rating")).find(function(t){return t.id===e.props.book.id}).rate:0}),o.a.createElement("label",{style:{display:this.state.showCheckBox||this.state.bookSelected?"inline-block":"none"},className:"pure-material-checkbox"},o.a.createElement("input",{onChange:function(t){e.selectBook(t)},type:"checkbox",defaultChecked:!(!localStorage.getItem("selectedBooks")||!JSON.parse(localStorage.getItem("selectedBooks")).find(function(t){return t===e.props.book.id}))}),o.a.createElement("span",null)))))}}]),t}(n.Component),C=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={books:[],query:"",spinner:!1},a.timeout=null,a.handleShelfChange=function(){E(a.state.query).then(function(e){a.setState({books:e})})},a.handleSelectBook=function(e){a.props.selectBook(e)},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"onSearch",value:function(e){var t=this,a=JSON.parse(localStorage.getItem("books")),n=e.target.value.trim();clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.setState({spinner:!0}),""!==e.target.value.trim()?E(n).then(function(e){var o=Array.isArray(e)&&e.filter(function(e){return e.imageLinks&&void 0!==e.imageLinks.thumbnail?e:""});o&&o.map(function(e){var t=a.find(function(t){return t.id===e.id});return t?e.shelf=t.shelf:e}),t.setState({books:o,query:n}),t.setState({spinner:!1})}):(t.setState({books:[],query:""}),t.setState({spinner:!1}))},1e3)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"search-books"},o.a.createElement("div",{className:"search-books-bar"},o.a.createElement(c.b,{to:"/"},o.a.createElement("button",{className:"close-search"},"Close")),o.a.createElement("div",{className:"search-books-input-wrapper"},o.a.createElement("input",{type:"text",placeholder:"Search by title or author",onChange:function(t){e.onSearch(t)}}))),o.a.createElement(d.a,{active:this.state.spinner,spinner:!0,text:"Loading your content..."},o.a.createElement("div",{className:"search-books-results"},o.a.createElement("ol",{className:"books-grid ".concat(""===this.state.query?"display-none":"")},this.state.books&&this.state.books.length>0?this.state.books.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(j,{book:t,shelf:e.handleShelfChange,selectBook:function(t){return e.handleSelectBook(t)}}))}):o.a.createElement("p",null,"No results found. Please refine your search")))))}}]),t}(n.Component),w=(a(61),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).handleShelfChange=function(){a.props.refresh()},a.handleSelectBook=function(e){a.props.selectBook(e)},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"bookshelf",id:this.props.title.replace(/\s+/g,"")},o.a.createElement("h2",{className:"bookshelf-title"},this.props.title),o.a.createElement("div",{className:"bookshelf-books"},o.a.createElement("ol",{className:"books-grid"},this.props.books.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(j,{book:t,shelf:e.handleShelfChange,selectBook:function(t){return e.handleSelectBook(t)}}))}))))}}]),t}(n.Component)),R=(a(63),a(16));var I=function(){return o.a.createElement("div",{className:"list-books-title"},o.a.createElement("div",{className:"left-side"},o.a.createElement("h1",null,"MyReads")),o.a.createElement("div",{className:"right-side"},o.a.createElement(R.Link,{activeClass:"active",to:"CurrentlyReading",spy:!0,smooth:!0,offset:-70,duration:500,className:"smooth-link"},"Currently Reading"),o.a.createElement(R.Link,{activeClass:"active",to:"WanttoRead",spy:!0,smooth:!0,offset:-70,duration:500,className:"smooth-link"},"Want to Read"),o.a.createElement(R.Link,{activeClass:"active",to:"Read",spy:!0,smooth:!0,offset:-70,duration:500,className:"smooth-link"},"Read")))},J=(a(74),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).bookShelves=[{id:"currentlyReading",title:"Currently Reading"},{id:"wantToRead",title:"Want to Read"},{id:"read",title:"Read"}],a.state={books:[]},a.getAllBooks=function(){g().then(function(e){a.setState(function(t){if(JSON.stringify(t.books)===JSON.stringify(e))return{books:[]}}),setTimeout(function(){a.setState(function(){return{books:e}}),localStorage.setItem("books",JSON.stringify(e))},0)})},a.componentDidMount=function(){a.getAllBooks()},a.handleRefresh=function(){a.getAllBooks()},a.handleSelectBook=function(e){a.props.selectBookEvent(e)},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(d.a,{active:0===this.state.books.length,spinner:!0,text:"Loading your content..."},o.a.createElement("div",{className:"list-books"},o.a.createElement(I,null),o.a.createElement("div",{className:"list-books-content"},o.a.createElement("div",null,this.bookShelves.map(function(t){return e.state.books.length>0?o.a.createElement(w,{key:t.id,title:t.title,books:e.state.books.filter(function(e){return e.shelf===t.id}),refresh:e.handleRefresh,selectBook:e.handleSelectBook}):""}))),o.a.createElement("div",{className:"open-search",title:"koko"},o.a.createElement(c.b,{to:"/search"},o.a.createElement("button",null,"Search a book")))))}}]),t}(n.Component)),M=a(0),A=a(24),x=a.n(A),L=a(33),T=(a(78),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).moveAll=function(){var e=Object(L.a)(x.a.mark(function e(t){var n,o;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=JSON.parse(localStorage.getItem("selectedBooks")),o=n.map(function(e){return new Promise(function(a,n){y(e,t).then(function(e){return a(e)})})}),Promise.all(o).finally(function(){localStorage.removeItem("selectedBooks"),a.props.afterMove()});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.unselectAll=function(){localStorage.removeItem("selectedBooks"),a.props.afterMove()},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{display:this.props.select||localStorage.getItem("selectedBooks")&&JSON.parse(localStorage.getItem("selectedBooks")).length>0?"block":"none"},className:"bucket-container"},o.a.createElement("p",{className:"move-all"},"Move all to:"),o.a.createElement("div",{className:"btns-container"},o.a.createElement("span",{className:"cat-name-button",onClick:function(){return e.moveAll("currentlyReading")}},"Currently Reading"),o.a.createElement("span",{className:"cat-name-button",onClick:function(){return e.moveAll("wantToRead")}},"Want To Read"),o.a.createElement("span",{className:"cat-name-button",onClick:function(){return e.moveAll("read")}},"Read")),o.a.createElement("span",{className:"remove-all",title:"Unselect All",onClick:this.unselectAll}))}}]),t}(n.Component)),q=(a(80),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={selectBook:!1},a.selectBookEvent=function(e,t){a.setState({selectBook:e});var n=window.location;"afterMove"===t&&"/search"!==n.pathname&&a.myRef.current.getAllBooks(),"afterMove"===t&&"/search"===n.pathname&&(window.location.pathname="/")},a.myRef=o.a.createRef(),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"app"},o.a.createElement("span",{className:"test"}),o.a.createElement(M.c,null,o.a.createElement(M.a,{exact:!0,path:"/",element:o.a.createElement(J,{selectBookEvent:function(t){return e.selectBookEvent(t)},ref:this.myRef})}),o.a.createElement(M.a,{path:"/search",element:o.a.createElement(C,{selectBook:function(t){return e.selectBookEvent(t)}})})),o.a.createElement(T,{select:this.state.selectBook,afterMove:function(t){return e.selectBookEvent(!1,"afterMove")}}))}}]),t}(o.a.Component));a(82);r.a.createRoot(document.getElementById("root")).render(o.a.createElement(c.a,{basename:"/React-manage-myreads"},o.a.createElement(q,null)))}},[[35,2,1]]]);
//# sourceMappingURL=main.a30998f7.chunk.js.map